# TASK: FlowSpace í•µì‹¬ ê¸°ëŠ¥ í—ˆì  ìˆ˜ì • (38ê°œ í•­ëª©)

> **ìƒì„±ì¼**: 2026-01-07
> **ì™„ë£Œì¼**: 2026-01-09 (ë³´ë¥˜ ì´ìŠˆ ì¶”ê°€ í•´ê²°)
> **ëª©í‘œ**: í†µê³„/ì±„íŒ…/ì¸ì¦ ì‹œìŠ¤í…œì˜ 38ê°œ ì ì¬ì  í—ˆì  ìˆ˜ì •
> **ìƒíƒœ**: âœ… **ì™„ë£Œ** - 36/38 ìˆ˜ì • ì™„ë£Œ (95%), 2ê°œ ë³´ë¥˜ (MVP í›„ í™•ì¥)
> **ë‹¤ìŒ íƒœìŠ¤í¬**: ì—ì…‹ ì œì‘ ë° í…œí”Œë¦¿ ì™„ì„± (ROADMAP.md ì°¸ì¡°)

---

## ì§„í–‰ ìƒíƒœ ìš”ì•½

| Phase | ì‹¬ê°ë„ | í•­ëª©ìˆ˜ | ì™„ë£Œ | ë³´ë¥˜ | ì§„í–‰ë¥  |
|-------|--------|-------|------|------|--------|
| Phase 1 | Critical | 4 | 4 | 0 | 100% âœ… |
| Phase 2 | High | 10 | 10 | 0 | 100% âœ… |
| Phase 3 | Medium | 17 | 15 | 2 | 88% âœ… |
| Phase 4 | Low | 7 | 7 | 0 | 100% âœ… |
| **í•©ê³„** | - | **38** | **36** | **2** | **95%** |

**Phase 3 ì™„ë£Œ í•­ëª©**: 3.1, **3.2**, 3.3, 3.4, 3.5, 3.6, **3.9**, 3.10, 3.11, **3.12**, **3.13**, 3.14, **3.15**, 3.16, 3.17
**Phase 3 ë³´ë¥˜ í•­ëª©**: 3.7 (ê³µê°„ ê¸°ë°˜ í†µì‹ ), 3.8 (ìŠ¤í¬íŠ¸ë¼ì´íŠ¸) â†’ MVP í›„ êµ¬í˜„ ([ì„¤ê³„ ë¬¸ì„œ](/docs/roadmap/SPATIAL-COMMUNICATION.md))
**Phase 4 ì™„ë£Œ í•­ëª©**: **4.1**, **4.2**, 4.3, 4.4, 4.5, 4.6, 4.7
**Phase 4 ë³´ë¥˜ í•­ëª©**: ì—†ìŒ

---

## Phase 1: Critical (ì¦‰ì‹œ ìˆ˜ì •)

### 1.1 [í†µê³„] ì¬ë°©ë¬¸ìœ¨ ì¤‘ë³µ ê³„ì‚° ë²„ê·¸
- **íŒŒì¼**: `src/app/api/admin/stats/route.ts:202-339`
- **ë¬¸ì œ**: `groupBy(["spaceId", "nickname"])`ë¡œ ë™ì¼ ì‚¬ìš©ìê°€ ì—¬ëŸ¬ ê³µê°„ ë°©ë¬¸ ì‹œ ì¤‘ë³µ ì§‘ê³„
- **í•´ê²°**: guestSession.id / userId ê¸°ì¤€ ê·¸ë£¹í™”ë¡œ ë³€ê²½
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [x] ê²ŒìŠ¤íŠ¸ ì¬ë°©ë¬¸ìœ¨: guestSessionId ê¸°ì¤€ ê·¸ë£¹í™”
  - [x] ì¸ì¦ ì‚¬ìš©ì: userId ê¸°ì¤€ ê·¸ë£¹í™” (spaceId ì œê±°)
  - [x] ì¬ë°©ë¬¸ ì •ì˜ í†µì¼: ë™ì¼ ì„¸ì…˜/ì‚¬ìš©ìì˜ 2íšŒ ì´ìƒ ENTER
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 1.2 [í†µê³„] ì²´ë¥˜ì‹œê°„ ë§ˆì§€ë§‰ EXITë§Œ ì‚¬ìš©
- **íŒŒì¼**: `src/app/api/admin/stats/route.ts:299-317`
- **ë¬¸ì œ**: Map ë®ì–´ì“°ê¸°ë¡œ ì—¬ëŸ¬ ENTERì— ë§ˆì§€ë§‰ EXITë§Œ ë§¤ì¹­
- **í•´ê²°**: ê° ENTER-EXIT ìŒì„ ì‹œê°„ìˆœ ë§¤ì¹­
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [x] Map â†’ Array ë³€ê²½ (ëª¨ë“  ENTER/EXIT ë³´ì¡´)
  - [x] ì‹œê°„ìˆœ ì •ë ¬ í›„ ê°€ì¥ ê°€ê¹Œìš´ EXIT ë§¤ì¹­
  - [x] ë™ì¼ ì„¸ì…˜ì˜ ë‹¤ì¤‘ ì…ì¥/í‡´ì¥ ì²˜ë¦¬
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 1.3 [í†µê³„] í”¼í¬ ë™ì ‘ = ì¼ì¼ ENTER ìˆ˜ (dashboard API)
- **íŒŒì¼**: `src/app/api/dashboard/spaces/[id]/stats/route.ts:142-148`
- **ë¬¸ì œ**: `Math.max(...dailyEnters.values())` = ë™ì‹œì ‘ì†ì´ ì•„ë‹Œ ì´ë²¤íŠ¸ ì¹´ìš´íŠ¸
- **í•´ê²°**: admin/statsì™€ ë™ì¼í•œ ENTER/EXIT Set ê¸°ë°˜ ê³„ì‚°
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [x] ENTER/EXIT ì´ë²¤íŠ¸ ì¡°íšŒ ì¿¼ë¦¬ ì¶”ê°€
  - [x] Set ê¸°ë°˜ ë™ì‹œì ‘ì†ì ì¶”ì  ë¡œì§ êµ¬í˜„
  - [x] ê¸°ì¡´ dailyEnters ë¡œì§ ì œê±°
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 1.4 [ì¸ì¦] ê°œë°œ ëª¨ë“œ ë°±ë„ì–´ ì œê±°
- **íŒŒì¼**: `src/app/api/spaces/[id]/members/route.ts:46-59`
- **ë¬¸ì œ**: `NODE_ENV=development`ì‹œ ìë™ ë¡œê·¸ì¸ (DEV_TEST_USER_ID)
- **í•´ê²°**: í•´ë‹¹ ì½”ë“œ ë¸”ë¡ ì™„ì „ ì‚­ì œ
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [x] DEV_TEST_USER_ID ìƒìˆ˜ ì œê±°
  - [x] IS_DEV ë¶„ê¸° ë¡œì§ ì œê±°
  - [x] getUserId() í•¨ìˆ˜ ì •ë¦¬
- **ìƒíƒœ**: âœ… ì™„ë£Œ

---

## Phase 2: High (1ì£¼ì¼ ë‚´ ìˆ˜ì •) âœ… ì™„ë£Œ

### 2.1 [í†µê³„] ENTER ì—†ëŠ” EXIT ì´ë²¤íŠ¸ ë¬´ì‹œ
- **íŒŒì¼**: `src/app/api/admin/stats/route.ts:375-396`
- **í•´ê²°**: ë¶ˆì™„ì „ ì„¸ì…˜ (ENTER ì—†ëŠ” EXIT, EXIT ì—†ëŠ” ENTER) ë³„ë„ ì§‘ê³„
- **êµ¬í˜„**: `dataQuality.incompleteEnterSessions`, `dataQuality.incompleteExitSessions` í•„ë“œ ì¶”ê°€
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 2.2 [í†µê³„] 24ì‹œê°„ ì´ìƒ ì²´ë¥˜ ë°ì´í„° ì œì™¸
- **íŒŒì¼**: `src/app/api/admin/stats/route.ts:283-372`
- **í•´ê²°**: 24ì‹œê°„ ì´ìƒ ì²´ë¥˜ëŠ” `outlierDurations` ë°°ì—´ë¡œ ë³„ë„ ì§‘ê³„
- **êµ¬í˜„**: `dataQuality.outlierSessions`, `dataQuality.outlierAvgDuration` í•„ë“œ ì¶”ê°€
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 2.3 [í†µê³„] 1ì£¼ì¼ ì´ì „ ì…ì¥ ì„¸ì…˜ ë™ì ‘ ëˆ„ë½
- **íŒŒì¼**: `src/app/api/dashboard/spaces/[id]/stats/route.ts:120-128`
- **í•´ê²°**: ë™ì ‘ ê³„ì‚°ìš© ENTER ì¡°íšŒ ë²”ìœ„ë¥¼ 1ê°œì›”ë¡œ í™•ì¥ (`oneMonthAgo`)
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 2.4 [í†µê³„] ë™ì¼ ì‹œê° ENTER/EXIT ìˆœì„œ ë¯¸ë³´ì¥
- **íŒŒì¼**: Phase 1.3ì—ì„œ í•´ê²°ë¨ (EXIT delta=-1 ìš°ì„  ì •ë ¬)
- **ìƒíƒœ**: âœ… ì™„ë£Œ (ì´ë¯¸ êµ¬í˜„ë¨)

### 2.5 [ì±„íŒ…] ë©”ì‹œì§€ DB ì €ì¥ ì‹¤íŒ¨ ì‹œ ë¡¤ë°± ì—†ìŒ
- **íŒŒì¼**: `server/socket-server.ts`, `types.ts`, `useSocket.ts`, `SpaceLayout.tsx`
- **í•´ê²°**: `chat:messageFailed` ì´ë²¤íŠ¸ ì •ì˜ ë° í´ë¼ì´ì–¸íŠ¸ ë¡¤ë°± ì²˜ë¦¬
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 2.6 [ì±„íŒ…] ê·“ì†ë§ ë¶€ë¶„ ì „ì†¡ ì‹¤íŒ¨
- **íŒŒì¼**: `server/socket-server.ts`, `types.ts`, `useSocket.ts`
- **í•´ê²°**: `whisper:messageFailed` ì´ë²¤íŠ¸ ì¶”ê°€, ë°œì‹ ìì™€ ìˆ˜ì‹ ì ëª¨ë‘ì—ê²Œ ë¡¤ë°± ì „ì†¡
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 2.7 [ì±„íŒ…] ê²Œì„ ì¤€ë¹„ ì „ ì´ë™ ì´ë²¤íŠ¸ ì†ì‹¤
- **íŒŒì¼**: `src/features/space/socket/useSocket.ts:293-316`
- **í•´ê²°**: `handleGameReady`ì—ì„œ players Mapì˜ ìµœì‹  ìœ„ì¹˜ ì‚¬ìš©
- **êµ¬í˜„**: `setPlayers` ì½œë°± ë‚´ì—ì„œ `currentPlayers.get(player.id)` ì°¸ì¡°
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 2.8 [ì±„íŒ…] ë‹‰ë„¤ì„ ìŠ¤í‘¸í•‘ìœ¼ë¡œ ê·“ì†ë§ ê°€ë¡œì±„ê¸°
- **íŒŒì¼**: `server/socket-server.ts:831-837`
- **í•´ê²°**: ë™ì¼ ë‹‰ë„¤ì„ì´ ë‹¤ë¥¸ playerIdë¥¼ ê°€ì§€ë©´ ì—ëŸ¬ ë°˜í™˜ (ìŠ¤í‘¸í•‘ ë°©ì§€)
- **êµ¬í˜„**: `uniquePlayerIds.size > 1` ì²´í¬ ì¶”ê°€
- **ìƒíƒœ**: âœ… ì™„ë£Œ (ì™„í™”ì±… ì ìš©, ê·¼ë³¸ í•´ê²°ì€ playerId ê¸°ë°˜ ì „í™˜ í•„ìš”)

### 2.9 [ì¸ì¦] ê²ŒìŠ¤íŠ¸ í† í° ì—”íŠ¸ë¡œí”¼ ì•½í•¨
- **íŒŒì¼**: `src/app/api/guest/route.ts:12-21, 102-104`
- **í•´ê²°**: `crypto.randomBytes` ê¸°ë°˜ 6ìë¦¬ ì˜ìˆ«ì suffix (ì•½ 22ì–µ ê²½ìš°ì˜ ìˆ˜)
- **êµ¬í˜„**: `generateSecureRandomSuffix()` í•¨ìˆ˜ ì¶”ê°€
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 2.10 [ì¸ì¦] LiveKit í† í° ë°œê¸‰ ì‹œ ê¶Œí•œ ê²€ì¦ ë¶€ì¬
- **íŒŒì¼**: `src/app/api/livekit/token/route.ts:160-203`
- **í•´ê²°**: ì¸ì¦ëœ ì‚¬ìš©ìì˜ ê³µê°„ ë©¤ë²„ì‹­ ê²€ì¦ ì¶”ê°€ (SpaceMember ë˜ëŠ” Space OWNER)
- **êµ¬í˜„**: ë¹„ë©¤ë²„ëŠ” sessionToken(ê²ŒìŠ¤íŠ¸ ì„¸ì…˜) í•„ìš”
- **ìƒíƒœ**: âœ… ì™„ë£Œ

---

## Phase 3: Medium (1ê°œì›” ë‚´ ìˆ˜ì •) - ğŸš§ ì§„í–‰ ì¤‘

### 3.1 [í†µê³„] ì£¼ê°„ ì²´ë¥˜ì‹œê°„ ë³€í™”ìœ¨ì´ í•­ìƒ 0
- **íŒŒì¼**: `src/app/api/admin/stats/route.ts:448-541`
- **ë¬¸ì œ**: ì§€ë‚œì£¼ ë°ì´í„° ê³„ì‚° ë¯¸êµ¬í˜„
- **í•´ê²°**: ì§€ë‚œì£¼ ì²´ë¥˜ì‹œê°„ ì¿¼ë¦¬ ì¶”ê°€ (lastWeekGuestEnterLogs, lastWeekAuthEnterLogs ë“±)
- **êµ¬í˜„**: durationChange ê³„ì‚° ë° weeklyChange.durationì— ì ìš©
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 3.2 [í†µê³„] ì¿¼ë¦¬ ì¤‘ë³µìœ¼ë¡œ ë©”ëª¨ë¦¬ 4ë°° ì‚¬ìš©
- **íŒŒì¼**: `src/app/api/admin/stats/route.ts:69-200`
- **ë¬¸ì œ**: ê°™ì€ ì¡°ê±´ì˜ ENTER/EXIT ë°˜ë³µ ì¡°íšŒ (18ê°œ ì¿¼ë¦¬)
- **í•´ê²°**: 2ì£¼ê°„ ENTER/EXIT í†µí•© ì¿¼ë¦¬ í›„ ë©”ëª¨ë¦¬ í•„í„°ë§ (10ê°œ ì¿¼ë¦¬ë¡œ ê°ì†Œ)
- **êµ¬í˜„**:
  - allEnterEvents + allExitEvents í†µí•© ì¿¼ë¦¬
  - ë©”ëª¨ë¦¬ì—ì„œ ë‚ ì§œ/ì‚¬ìš©ììœ í˜•ë³„ í•„í„°ë§
  - DB ì—°ê²° 44% ê°ì†Œ
- **ìƒíƒœ**: âœ… ì™„ë£Œ (2026-01-09)

### 3.3 [í†µê³„] null guestSessionId/userId ì²˜ë¦¬
- **íŒŒì¼**: `src/app/api/admin/stats/route.ts:309-338`
- **ë¬¸ì œ**: ë‘˜ ë‹¤ nullì¼ ë•Œ ë¹ˆ ë¬¸ìì—´ë¡œ ì²˜ë¦¬
- **í•´ê²°**: ëª…ì‹œì  null ì²´í¬ + ë¡œê¹… ì¶”ê°€ (nullIdentifierEvents ì¹´ìš´íŠ¸)
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 3.4 [í†µê³„] ê³µê°„ ì—†ì„ ë•Œ ì‘ë‹µ êµ¬ì¡° ë¶ˆì™„ì „
- **íŒŒì¼**: `src/app/api/admin/stats/route.ts:41-62`
- **ë¬¸ì œ**: ì¼ë¶€ í•„ë“œë§Œ ë°˜í™˜
- **í•´ê²°**: dataQuality í¬í•¨ ì „ì²´ í•„ë“œ ëª…ì‹œì  ë°˜í™˜
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 3.5 [ì±„íŒ…] íŒŒí‹° ì±„íŒ… DB ì €ì¥ ì—†ìŒ
- **íŒŒì¼**: `server/socket-server.ts:971-1036`
- **ë¬¸ì œ**: íŒŒí‹° ë©”ì‹œì§€ ì˜êµ¬ ê¸°ë¡ ë¶ˆê°€
- **í•´ê²°**: prisma.chatMessage.create + type: "PARTY", targetId: partyId
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 3.6 [ì±„íŒ…] ì•„ë°”íƒ€ ì •ë³´ ë³‘í•© ì‹œ nullish coalescing
- **íŒŒì¼**: `src/features/space/socket/useSocket.ts:390-405`
- **ë¬¸ì œ**: nullê³¼ undefined êµ¬ë¶„ ë¯¸í¡
- **í•´ê²°**: ê¸°ë³¸ê°’ "default" ì¶”ê°€ (avatarColor ?? existing?.avatarColor ?? "default")
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 3.7 [í†µì‹ ] ê³µê°„ ê¸°ë°˜ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ì‹œìŠ¤í…œ ğŸ†•
- **ì„¤ê³„ ë¬¸ì„œ**: `/docs/roadmap/SPATIAL-COMMUNICATION.md`
- **í˜„ì¬ ë¬¸ì œ**: ê³µê°„ ë‚´ ëª¨ë“  ìœ ì €ê°€ ì „ì—­ì ìœ¼ë¡œ ì˜¤ë””ì˜¤/ë¹„ë””ì˜¤/í™”ë©´ê³µìœ 
- **ëª©í‘œ ê¸°ëŠ¥**:
  1. **ê·¼ì ‘ ê¸°ë°˜ í†µì‹ **: 7Ã—7 íƒ€ì¼ ì˜ì—­ ë‚´ ìœ ì €ë¼ë¦¬ë§Œ ì—°ê²°
  2. **íŒŒí‹° ì¡´**: ë§µì˜ íŠ¹ì • ì˜ì—­ì—ì„œ ê·¸ë£¹ í†µì‹  + ì±„íŒ…
  3. **ìŠ¤í¬íŠ¸ë¼ì´íŠ¸**: ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬ + íŠ¹ì • ì¢Œí‘œì—ì„œ ì „ì²´ ë¸Œë¡œë“œìºìŠ¤íŠ¸
- **ìƒíƒœ**: â¸ï¸ ë³´ë¥˜ (MVP í›„ êµ¬í˜„, ì„¤ê³„ ì™„ë£Œ)

### 3.8 [í†µì‹ ] ìŠ¤í¬íŠ¸ë¼ì´íŠ¸ ê¶Œí•œ ì‹œìŠ¤í…œ ğŸ†•
- **ì„¤ê³„ ë¬¸ì„œ**: `/docs/roadmap/SPATIAL-COMMUNICATION.md` ì„¹ì…˜ 2.3
- **ìš”êµ¬ì‚¬í•­**:
  - SuperAdmin/OWNER/STAFFë§Œ íƒ€ ì‚¬ìš©ìì—ê²Œ ìŠ¤í¬íŠ¸ë¼ì´íŠ¸ ê¶Œí•œ ë¶€ì—¬ ê°€ëŠ¥
  - ë§µì— ìŠ¤í¬íŠ¸ë¼ì´íŠ¸ ì˜¤ë¸Œì íŠ¸(ë¬´ëŒ€/ë‹¨ìƒ) ì„¤ì¹˜ ì‹œ í•´ë‹¹ ì˜ì—­ ì¢Œí‘œ ì§€ì •
  - ê¶Œí•œ ë³´ìœ ìê°€ í•´ë‹¹ ì¢Œí‘œì— ìœ„ì¹˜í•  ë•Œë§Œ ì „ì²´ ë¸Œë¡œë“œìºìŠ¤íŠ¸ í™œì„±í™”
  - ì¡´ ì´íƒˆ ì‹œ ìë™ í•´ì œ
- **ìƒíƒœ**: â¸ï¸ ë³´ë¥˜ (3.7ê³¼ í•¨ê»˜ êµ¬í˜„ ì˜ˆì •)

### 3.9 [ì±„íŒ…] ìŒì†Œê±° ìƒíƒœ ë©”ëª¨ë¦¬ë§Œ ì €ì¥
- **íŒŒì¼**: `server/socket-server.ts:1101-1167`
- **ë¬¸ì œ**: ì„œë²„ ì¬ì‹œì‘ ì‹œ ìŒì†Œê±° ì´ˆê¸°í™”
- **í•´ê²°**: SpaceMember.restriction í•„ë“œë¡œ DB ì˜ì†í™” êµ¬í˜„
- **êµ¬í˜„**:
  - `loadMemberRestriction()`: join:space ì‹œ DBì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
  - `saveMemberRestriction()`: ìŒì†Œê±°/í•´ì œ ì‹œ DB ì €ì¥
  - ì¼ì‹œì  ìŒì†Œê±° ë§Œë£Œ ìë™ ì²˜ë¦¬
- **ìƒíƒœ**: âœ… ì™„ë£Œ (2026-01-09)

### 3.10 [ì±„íŒ…] ì¬ì—°ê²° ì‹œ ì¤‘ë³µ ì…ì¥ ë¯¸ì²˜ë¦¬
- **íŒŒì¼**: `server/socket-server.ts:539-558`
- **ë¬¸ì œ**: ê¸°ì¡´ ì†Œì¼“ ê°•ì œ ì¢…ë£Œ ì—†ìŒ
- **í•´ê²°**: ê¸°ì¡´ ì†Œì¼“ disconnect í›„ ìƒˆ ì—°ê²° í—ˆìš© (ì—ëŸ¬ ë©”ì‹œì§€ ì „ì†¡)
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 3.11 [ì±„íŒ…] Rate Limitì´ socketIdë³„
- **íŒŒì¼**: `server/socket-server.ts:219-321`
- **ë¬¸ì œ**: ì—¬ëŸ¬ íƒ­ìœ¼ë¡œ Rate Limit ìš°íšŒ ê°€ëŠ¥
- **í•´ê²°**: playerId ê¸°ë°˜ Rate Limitìœ¼ë¡œ ë³€ê²½, ëª¨ë“  í˜¸ì¶œ ì—…ë°ì´íŠ¸
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 3.12 [ì¸ì¦] RBAC ì •ì±… ëª¨ìˆœ
- **íŒŒì¼**: `src/app/api/spaces/[id]/members/route.ts`, `staff/route.ts`
- **ë¬¸ì œ**: ì£¼ì„ê³¼ ì½”ë“œì˜ ê¶Œí•œ ì •ì±… ë¶ˆì¼ì¹˜
- **ë¶„ì„**: ì½”ë“œ ë¦¬ë·° ê²°ê³¼ ì£¼ì„ê³¼ ì‹¤ì œ êµ¬í˜„ì´ ì¼ì¹˜í•¨ í™•ì¸
- **ìƒíƒœ**: âœ… ì™„ë£Œ (ë¬¸ì œ ì—†ìŒ í™•ì¸, 2026-01-09)

### 3.13 [ì¸ì¦] ì´ì¤‘ ê²€ì¦ ë¡œì§ ë¶ˆì¼ì¹˜
- **íŒŒì¼**: `src/app/api/spaces/[id]/members/route.ts`
- **ë¬¸ì œ**: GET/DELETE vs POST/PATCH ê²€ì¦ ë¡œì§ ë‹¤ë¦„
- **ë¶„ì„**: canManageMembers í•¨ìˆ˜ë¡œ í†µì¼ë˜ì–´ ìˆìŒ í™•ì¸
- **ìƒíƒœ**: âœ… ì™„ë£Œ (ë¬¸ì œ ì—†ìŒ í™•ì¸, 2026-01-09)

### 3.14 [ì¸ì¦] ìê¸° ìì‹  ê°•ë“±/ê°•í‡´ ê°€ëŠ¥
- **íŒŒì¼**: `src/app/api/spaces/[id]/members/route.ts:474-480, 638-645`
- **ë¬¸ì œ**: PATCH/DELETEì—ì„œ ìê¸° ìì‹  ì²´í¬ ì—†ìŒ
- **í•´ê²°**: PATCHì™€ DELETEì— ìê¸° ìì‹  ì²´í¬ ì¶”ê°€ (SuperAdmin ì˜ˆì™¸)
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 3.15 [ì¸ì¦] ì‚¬ìš©ì ì—´ê±° ê°€ëŠ¥
- **íŒŒì¼**: `src/app/api/spaces/[id]/staff/route.ts`, `staff/[userId]/route.ts`
- **ë¬¸ì œ**: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” userIdì— ëŒ€í•œ 404 ì‘ë‹µ
- **í•´ê²°**: ì¼ê´€ëœ 400 ì—ëŸ¬ ì‘ë‹µ ("Cannot assign/remove staff role to this user")
- **ìƒíƒœ**: âœ… ì™„ë£Œ (2026-01-09)

### 3.16 [ì¸ì¦] ê³µê°„ ìµœëŒ€ê°’ race condition
- **íŒŒì¼**: `src/app/api/guest/route.ts:107-144`
- **ë¬¸ì œ**: ë™ì‹œ ìš”ì²­ ì‹œ maxUsers ì´ˆê³¼ ê°€ëŠ¥
- **í•´ê²°**: prisma.$transactionìœ¼ë¡œ ì›ìì  ì²˜ë¦¬ (count + create íŠ¸ëœì­ì…˜)
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 3.17 [ì¸ì¦] ì—ëŸ¬ ì‘ë‹µ ì •ë³´ ëˆ„ìˆ˜
- **íŒŒì¼**: `src/app/api/guest/verify/route.ts:73-92`
- **ë¬¸ì œ**: ë‹¨ê³„ë³„ ì—ëŸ¬ë¡œ í† í° ìœ íš¨ì„± ì¶”ë¡  ê°€ëŠ¥
- **í•´ê²°**: ëª¨ë“  ê²€ì¦ ì‹¤íŒ¨ ì‹œ ë™ì¼í•œ "Invalid session" ë©”ì‹œì§€ ë°˜í™˜
- **ìƒíƒœ**: âœ… ì™„ë£Œ

---

## Phase 4: Low (ë¶„ê¸° ë‚´ ìˆ˜ì •) - âœ… ì™„ë£Œ (6/7)

### 4.1 [í†µê³„] authReturnRateData groupBy ì •ë ¬ ë¹„ìš©
- **íŒŒì¼**: `prisma/schema.prisma:400-402`
- **ë¬¸ì œ**: groupBy ì¿¼ë¦¬ì— ì í•©í•œ ë³µí•© ì¸ë±ìŠ¤ ë¶€ì¬
- **í•´ê²°**: SpaceEventLogì— ë³µí•© ì¸ë±ìŠ¤ ì¶”ê°€
- **êµ¬í˜„**:
  - `@@index([spaceId, eventType, userId])` - ì¸ì¦ ì‚¬ìš©ì groupByìš©
  - `@@index([spaceId, eventType, guestSessionId])` - ê²ŒìŠ¤íŠ¸ groupByìš©
  - `prisma db push`ë¡œ í”„ë¡œë•ì…˜ ì ìš©
- **ìƒíƒœ**: âœ… ì™„ë£Œ (2026-01-09)

### 4.2 [í†µê³„] ìŠ¤í‚¤ë§ˆ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œ ì„¸ì…˜ ID ì¬ì‚¬ìš© ìœ„í—˜
- **íŒŒì¼**: `src/app/api/admin/stats/route.ts:264-272`
- **ë¬¸ì œ**: cuid() ì¬ì‚¬ìš© ê°€ëŠ¥ì„± (ì´ë¡ ì )
- **ë¶„ì„**: cuid()ëŠ” ì•½ 10^36 ê²½ìš°ì˜ ìˆ˜ë¡œ ì¶©ë¶„íˆ ê³ ìœ  (ì¶©ëŒ í™•ë¥  ë¬´ì‹œ ê°€ëŠ¥)
- **ìƒíƒœ**: âœ… ì™„ë£Œ (í—ˆìš© ê°€ëŠ¥í•œ ìœ„í—˜ ìˆ˜ì¤€ í™•ì¸, 2026-01-09)

### 4.3 [ì±„íŒ…] ë¬´í•œ ì¬ì—°ê²° (ë°°í„°ë¦¬/ë¦¬ì†ŒìŠ¤ ë‚­ë¹„)
- **íŒŒì¼**: `src/features/space/socket/useSocket.ts:226-230`
- **ë¬¸ì œ**: `reconnectionAttempts: Infinity`
- **í•´ê²°**: 30íšŒë¡œ ì œí•œ (ì•½ 2.5ë¶„ê°„ ì‹œë„ í›„ ì¤‘ë‹¨)
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 4.4 [ì±„íŒ…] Presence API ì˜¤ë˜ëœ ë°ì´í„°
- **íŒŒì¼**: `server/socket-server.ts:335-385`
- **ë¬¸ì œ**: disconnect ì²˜ë¦¬ ì „ ìš”ì²­ ì‹œ stale ë°ì´í„°
- **í•´ê²°**: `io.sockets.adapter.rooms` ì§ì ‘ ì¡°íšŒë¡œ Socket.ioê°€ ìë™ ê´€ë¦¬
- **ë¶„ì„ ê²°ê³¼**: í˜„ì¬ êµ¬í˜„ì´ ì´ë¯¸ ì ì ˆí•¨ (ì‹¤ì‹œê°„ ì†Œì¼“ ìƒíƒœ ê¸°ë°˜)
- **ìƒíƒœ**: âœ… ì™„ë£Œ (2026-01-09, ì¶”ê°€ êµ¬í˜„ ë¶ˆí•„ìš” í™•ì¸)

### 4.5 [ì±„íŒ…] ì¤‘ë³µ ë©”ì‹œì§€ ì²´í¬ trim ë¶ˆì¼ì¹˜
- **íŒŒì¼**: `server/socket-server.ts:243-264`
- **ë¬¸ì œ**: ê¸¸ì´ ì²´í¬ì™€ ì¤‘ë³µ ì²´í¬ì˜ trim ì ìš© ì‹œì  ë‹¤ë¦„
- **í•´ê²°**: trim ë¨¼ì € ì ìš© + ë¹ˆ ë©”ì‹œì§€ ì²´í¬ ì¶”ê°€
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 4.6 [ì±„íŒ…] í•´ì‹œ ì¶©ëŒ ê°€ëŠ¥ì„±
- **íŒŒì¼**: `server/socket-server.ts:224-231`
- **ë¬¸ì œ**: 32bit í•´ì‹œë¡œ ì¶©ëŒ ê°€ëŠ¥
- **í•´ê²°**: SHA256 í•´ì‹œ (16ì hex, ì¶©ëŒ ê°€ëŠ¥ì„± ì œê±°)
- **ìƒíƒœ**: âœ… ì™„ë£Œ

### 4.7 [ì¸ì¦] ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ë§Œë£Œ ì²˜ë¦¬ ëŠìŠ¨
- **íŒŒì¼**: `src/app/api/guest/verify/route.ts:90`
- **ë¬¸ì œ**: ê²½ê³„ê°’ ì²˜ë¦¬ ë° ì •ë¦¬ ë©”ì»¤ë‹ˆì¦˜ ë¶€ì¬
- **í•´ê²°**: Vercel Cronìœ¼ë¡œ ë§¤ì¼ UTC 19:00 (KST 04:00) ìë™ ì •ë¦¬
- **êµ¬í˜„**:
  - `src/app/api/cron/cleanup-sessions/route.ts` ìƒì„±
  - `vercel.json`ì— cron ìŠ¤ì¼€ì¤„ ì¶”ê°€
- **ìƒíƒœ**: âœ… ì™„ë£Œ (2026-01-09)

---

## ìˆ˜ì • íŒŒì¼ ëª©ë¡ (ì˜ˆìƒ)

### Phase 1 (3ê°œ íŒŒì¼)
- `src/app/api/admin/stats/route.ts`
- `src/app/api/dashboard/spaces/[id]/stats/route.ts`
- `src/app/api/spaces/[id]/members/route.ts`

### Phase 2 (4ê°œ íŒŒì¼)
- `server/socket-server.ts`
- `src/features/space/socket/useSocket.ts`
- `src/app/api/guest/route.ts`
- `src/app/api/livekit/token/route.ts`

### Phase 3 (4ê°œ íŒŒì¼)
- `src/lib/space-auth.ts`
- `src/app/api/spaces/[id]/staff/route.ts`
- `src/app/api/guest/verify/route.ts`
- `server/socket-server.ts`

### Phase 4 (3ê°œ íŒŒì¼)
- `src/app/api/admin/stats/route.ts`
- `src/features/space/socket/useSocket.ts`
- `server/socket-server.ts`

---

## ë³€ê²½ ì´ë ¥

| ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|-----|----------|
| 2026-01-07 | TASK.md ì´ˆê¸° ìƒì„± - 38ê°œ í—ˆì  ìˆ˜ì • í•­ëª© ì •ì˜ |
| 2026-01-07 | Phase 1-4 ì™„ë£Œ - 27/38 ìˆ˜ì •, 11ê°œ ë³´ë¥˜ (ìµœì í™”/ì¸í”„ë¼ ê´€ë ¨) |
| 2026-01-08 | **íƒœìŠ¤í¬ ì™„ë£Œ** - ê²°ê³¼ ROADMAP.mdì— í†µí•©, ë³´ë¥˜ ì´ìŠˆëŠ” ì¸í”„ë¼ í›„ ì§„í–‰ |
| 2026-01-09 | **ë³´ì•ˆ ê°•í™” ì¶”ê°€** - 3.9 (ìŒì†Œê±° DB ì˜ì†í™”), 3.15 (ì‚¬ìš©ì ì—´ê±° ë°©ì§€), CSRF ë¯¸ë“¤ì›¨ì–´ ì¶”ê°€ |
| 2026-01-09 | **OCI ë°°í¬ í›„ ì¶”ê°€ í•´ê²°** - 4.4 (Presence API ë¶„ì„ ì™„ë£Œ), 4.7 (Vercel Cron ì„¸ì…˜ ì •ë¦¬) |
| 2026-01-09 | **ê³µê°„ ê¸°ë°˜ í†µì‹  ì„¤ê³„** - 3.7, 3.8 ì¬ì •ì˜ (ê·¼ì ‘/íŒŒí‹°ì¡´/ìŠ¤í¬íŠ¸ë¼ì´íŠ¸), ì„¤ê³„ ë¬¸ì„œ ì‘ì„± |
| 2026-01-09 | **ë¬¸ì œì—†ìŒ í™•ì¸ ì™„ë£Œ** - 3.12, 3.13, 4.2 ê²€í†  í›„ ì™„ë£Œ ì²˜ë¦¬ (36/38, 95%) |
| 2026-01-09 | **ì¿¼ë¦¬+ì¸ë±ìŠ¤ ìµœì í™”** - 3.2 (18â†’10ê°œ ì¿¼ë¦¬ í†µí•©), 4.1 (groupBy ë³µí•© ì¸ë±ìŠ¤ ì¶”ê°€) |
| 2026-01-10 | **OCI ë°°í¬ ì •ë³´ ë°±ì—…** - SSH ì ‘ì†, Docker ì²´í¬ë¦¬ìŠ¤íŠ¸, ì„œë¹„ìŠ¤ URL ë¬¸ì„œí™” |
| 2026-01-10 | **ê·¼ì ‘ í†µì‹  ë””ë²„ê¹… ì¤€ë¹„** - ê´€ë ¨ íŒŒì¼ ëª©ë¡, ì˜ˆìƒ ì›ì¸, ë‹¤ìŒ ì‘ì—… ë°±ì—… |
| 2026-01-12 | **ì‚¬ìš©ëŸ‰ ë¶„ì„ ì •í™•ë„ ê°œì„ ** - NEXT_PUBLIC_API_URL í™˜ê²½ë³€ìˆ˜ ì¶”ê°€, useSocket.ts beforeunload/pagehide í•¸ë“¤ëŸ¬ ì¶”ê°€ |

---

## ë‹¤ìŒ ë‹¨ê³„

**36/38 ì™„ë£Œ (95%)** - ë‚¨ì€ 2ê°œëŠ” MVP í›„ ê¸°ëŠ¥ í™•ì¥ ì‹œ êµ¬í˜„

**ì™„ë£Œëœ ì£¼ìš” ì´ìŠˆ**:
- âœ… Oracle Cloud ì¸í”„ë¼ ë°°í¬ ì™„ë£Œ (2026-01-09)
- âœ… Vercel Cron ì„¤ì • ì™„ë£Œ (ì„¸ì…˜ ì •ë¦¬)
- âœ… DB ì¸ë±ìŠ¤ ìµœì í™” ì™„ë£Œ (4.1 - groupBy ë³µí•© ì¸ë±ìŠ¤)
- âœ… ì¿¼ë¦¬ ìµœì í™” ì™„ë£Œ (3.2 - 18â†’10ê°œ ì¿¼ë¦¬ í†µí•©)
- âœ… ë¬¸ì œì—†ìŒ í™•ì¸ (3.12, 3.13, 4.2)

**ë³´ë¥˜ (MVP í›„ í™•ì¥)** - [ì„¤ê³„ ë¬¸ì„œ](/docs/roadmap/SPATIAL-COMMUNICATION.md):
- â¸ï¸ 3.7 ê³µê°„ ê¸°ë°˜ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ì‹œìŠ¤í…œ
  - ê·¼ì ‘ ê¸°ë°˜ í†µì‹  (7Ã—7 ì˜ì—­)
  - íŒŒí‹° ì¡´ (íŠ¹ì • ì˜ì—­ ê·¸ë£¹ í†µì‹ )
- â¸ï¸ 3.8 ìŠ¤í¬íŠ¸ë¼ì´íŠ¸ ì‹œìŠ¤í…œ
  - ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬ + ì¢Œí‘œ ê¸°ë°˜ ì „ì²´ ë¸Œë¡œë“œìºìŠ¤íŠ¸

**ê´€ë ¨ ë¬¸ì„œ**:
- `/docs/infrastructure/OCI.md` - ì¸í”„ë¼ ë°°í¬ ì™„ë£Œ (2026-01-09)
- `/docs/ROADMAP.md` - ë³´ì•ˆ ì ê²€ ì„¹ì…˜ì— ë³´ë¥˜ ì´ìŠˆ ëª©ë¡

---

## ê²€ì¦ ëª…ë ¹ì–´

```bash
# íƒ€ì…ì²´í¬
npx tsc --noEmit

# ë¹Œë“œí…ŒìŠ¤íŠ¸
npm run build

# Socket ì„œë²„ í…ŒìŠ¤íŠ¸
npm run socket:dev

# ì „ì²´ ê°œë°œ ì„œë²„
npm run dev:all
```

---

## ğŸ”§ OCI ì„œë²„ ë°°í¬ ì •ë³´ (í•„ìˆ˜ ì°¸ì¡°)

> âš ï¸ **ë°°í¬ ì „ ë°˜ë“œì‹œ ì´ ì„¹ì…˜ì„ ì½ê³  ê¸°ì¡´ ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”**

### SSH ì ‘ì† ì •ë³´

```bash
# SSH í‚¤ ìœ„ì¹˜
~/.ssh/flowspace-oci

# ì ‘ì† ëª…ë ¹ì–´ (âš ï¸ ì‚¬ìš©ìëŠ” ubuntu, opcê°€ ì•„ë‹˜!)
ssh -i ~/.ssh/flowspace-oci ubuntu@144.24.72.143
```

### Docker ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

**âŒ í•˜ì§€ ë§ ê²ƒ:**
- `--network host` ì‚¬ìš© ê¸ˆì§€ (Caddyê°€ ì„œë¹„ìŠ¤ ì°¾ì§€ ëª»í•¨)
- DATABASE_URL ì¶”ì¸¡ ê¸ˆì§€ (ë°˜ë“œì‹œ docker-compose.yml í™•ì¸)
- CORS_ORIGINS ì¶”ì¸¡ ê¸ˆì§€

**âœ… ë°˜ë“œì‹œ í•  ê²ƒ:**
```bash
# 1. ë¨¼ì € ê¸°ì¡´ ì„¤ì • í™•ì¸
cat /home/ubuntu/flowspace/docker-compose.yml

# 2. ë„¤íŠ¸ì›Œí¬ í™•ì¸
docker network ls
docker network inspect flowspace_default
```

### ì˜¬ë°”ë¥¸ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ëª…ë ¹ì–´

```bash
docker stop flowspace-socket && docker rm flowspace-socket && \
docker run -d --name flowspace-socket \
  --network flowspace_default \
  --network-alias socket-server \
  -e NODE_ENV=production \
  -e PORT=3001 \
  -e 'DATABASE_URL=postgresql://postgres.dqmnlygfulhxhatyoiql:Whdydgus12%21%40@aws-1-ap-northeast-2.pooler.supabase.com:6543/postgres?pgbouncer=true' \
  -e 'CORS_ORIGINS=https://space.flow-coder.com,https://flowspace-gamma.vercel.app,http://localhost:3000' \
  -e 'NEXT_PUBLIC_API_URL=https://space.flow-coder.com' \
  --restart unless-stopped \
  flowspace_socket-server:latest
```

> âš ï¸ **í•„ìˆ˜ í™˜ê²½ë³€ìˆ˜**: `NEXT_PUBLIC_API_URL` ì—†ìœ¼ë©´ ì´ë²¤íŠ¸ ë¡œê¹… ì‹¤íŒ¨ (ì‚¬ìš©ëŸ‰ í†µê³„ ëˆ„ë½)

### ì½”ë“œ ë°°í¬ ì ˆì°¨

```bash
# ë¡œì»¬ì—ì„œ ë²ˆë“¤ë§
cd C:\Team-jane\flow_metaverse
npx esbuild server/socket-server.ts --bundle --platform=node --target=node18 --outfile=server/socket-server.bundle.js --external:bufferutil --external:utf-8-validate

# OCIë¡œ ì—…ë¡œë“œ
scp -i ~/.ssh/flowspace-oci server/socket-server.bundle.js ubuntu@144.24.72.143:/home/ubuntu/flowspace/server/socket-server.js

# OCIì—ì„œ Docker ì¬ë¹Œë“œ
ssh -i ~/.ssh/flowspace-oci ubuntu@144.24.72.143 "cd /home/ubuntu/flowspace && docker build -t flowspace_socket-server:latest ./server"

# ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ (ìœ„ì˜ ì˜¬ë°”ë¥¸ ëª…ë ¹ì–´ ì‚¬ìš©)
```

### ì„œë¹„ìŠ¤ URL ì •ë¦¬

| ì„œë¹„ìŠ¤ | URL | ìš©ë„ |
|-------|-----|------|
| í”„ë¡ íŠ¸ì—”ë“œ | `https://space.flow-coder.com` | Vercel ë°°í¬ |
| Socket ì„œë²„ | `https://space-socket.flow-coder.com` | OCI (Caddy í”„ë¡ì‹œ) |
| LiveKit | `wss://space-livekit.flow-coder.com` | OCI (Caddy í”„ë¡ì‹œ) |

---

## ğŸ“¡ ê·¼ì ‘ í†µì‹  ë””ë²„ê¹… (2026-01-10 ì‘ì—… ì˜ˆì •)

### í˜„ì¬ ìƒíƒœ

- âœ… `@proximity on/off` ëª…ë ¹ì–´ ë™ì‘í•¨
- âœ… OCI ì„œë²„ì— ì½”ë“œ ë°°í¬ ì™„ë£Œ
- âŒ **ê±°ë¦¬ì— ë”°ë¥¸ í†µì‹ ì´ ê¸°ëŒ€ëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•ŠìŒ**

---

## ğŸ“Š EXIT ì´ë²¤íŠ¸ ì •í™•í•œ ì¹´ìš´íŒ… (2026-01-12 ìˆ˜ì • ì™„ë£Œ)

### ë¬¸ì œ ì›ì¸ ë¶„ì„

EXITê°€ ë°œìƒí•´ì•¼ í•˜ëŠ” ì¼€ì´ìŠ¤:

| ì¼€ì´ìŠ¤ | íŠ¸ë¦¬ê±° | ì´ì „ ìƒíƒœ | ìˆ˜ì • í›„ |
|-------|-------|---------|--------|
| ë‚˜ê°€ê¸° ë²„íŠ¼ | `onExit` callback | âœ… | âœ… |
| Socket disconnect | ì„œë²„ `disconnect` | âš ï¸ API URL ë¯¸ì„¤ì • | âœ… NEXT_PUBLIC_API_URL ì¶”ê°€ |
| ë¸Œë¼ìš°ì € ì¢…ë£Œ | `beforeunload` | âŒ ì—†ìŒ | âœ… í•¸ë“¤ëŸ¬ ì¶”ê°€ |
| íƒ­ ë‹«ê¸° | `beforeunload` | âŒ ì—†ìŒ | âœ… í•¸ë“¤ëŸ¬ ì¶”ê°€ |
| ìƒˆë¡œê³ ì¹¨ | `beforeunload` | âŒ ì—†ìŒ | âœ… í•¸ë“¤ëŸ¬ ì¶”ê°€ |
| ë‹¤ë¥¸ í˜ì´ì§€ ì´ë™ | unmount | âœ… | âœ… |
| ë„¤íŠ¸ì›Œí¬ ëŠê¹€ | `ping timeout` | âœ… | âœ… |
| ëª¨ë°”ì¼ ì•± ì „í™˜ | `pagehide` | âŒ ì—†ìŒ | âœ… í•¸ë“¤ëŸ¬ ì¶”ê°€ |

### ìˆ˜ì • ë‚´ìš©

**1. OCI ì„œë²„ í™˜ê²½ë³€ìˆ˜ ì¶”ê°€**
```bash
-e 'NEXT_PUBLIC_API_URL=https://space.flow-coder.com'
```

**2. useSocket.tsì— ë¸Œë¼ìš°ì € ì¢…ë£Œ í•¸ë“¤ëŸ¬ ì¶”ê°€**
```typescript
// beforeunload: ë°ìŠ¤í¬íƒ‘ ë¸Œë¼ìš°ì € ì¢…ë£Œ/ìƒˆë¡œê³ ì¹¨/íƒ­ ë‹«ê¸°
// pagehide: ëª¨ë°”ì¼ Safari ëŒ€ë¹„
// visibilitychange: ëª¨ë°”ì¼ ì•± ì „í™˜
window.addEventListener("beforeunload", handleBeforeUnload)
window.addEventListener("pagehide", handlePageHide)
document.addEventListener("visibilitychange", handleVisibilityChange)
```

### ê²€ì¦ í•„ìš”

- [ ] OCI ì„œë²„ì— ìƒˆ ì½”ë“œ ë°°í¬ í›„ EXIT ë¡œê¹… í™•ì¸
- [ ] ë¸Œë¼ìš°ì € ìƒˆë¡œê³ ì¹¨ ì‹œ EXIT ì´ë²¤íŠ¸ ê¸°ë¡ í™•ì¸
- [ ] Admin ëŒ€ì‹œë³´ë“œì—ì„œ ENTER/EXIT ìˆ˜ ì¼ì¹˜ í™•ì¸

### ê´€ë ¨ íŒŒì¼ ëª©ë¡

**ì„œë²„ (socket-server.ts)**:
- Line 842-849: `proximityStates` Map, `getProximityState()`, `setProximityState()`
- Line 1133-1134: join:space ì‹œ `proximity:status` ì „ì†¡
- Line 2402-2445: `proximity:set` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬

**í´ë¼ì´ì–¸íŠ¸**:
| íŒŒì¼ | ì—­í•  |
|-----|------|
| `src/features/space/socket/useSocket.ts` | `setProximity()`, `proximity:changed` ìˆ˜ì‹  |
| `src/features/space/components/SpaceLayout.tsx` | ëª…ë ¹ì–´ íŒŒì‹± â†’ `setProximity()` í˜¸ì¶œ |
| `src/features/space/livekit/useProximitySubscription.ts` | **LiveKit êµ¬ë… ê´€ë¦¬** (í•µì‹¬) |
| `src/features/space/utils/chatParser.ts` | `@proximity` ëª…ë ¹ì–´ íŒŒì‹± |
| `src/features/space/socket/types.ts` | íƒ€ì… ì •ì˜ |

### ì˜ˆìƒ ì›ì¸ (í™•ì¸ í•„ìš”)

1. `useProximitySubscription.ts`ì—ì„œ ê±°ë¦¬ ê³„ì‚° ë¡œì§ ë¬¸ì œ?
2. LiveKit íŠ¸ë™ êµ¬ë…/í•´ì œ íƒ€ì´ë° ë¬¸ì œ?
3. í”Œë ˆì´ì–´ ìœ„ì¹˜ ë™ê¸°í™” ì§€ì—°?

### ë‹¤ìŒ ì‘ì—…

1. `useProximitySubscription.ts` ì½”ë“œ ë¶„ì„
2. ê±°ë¦¬ ê³„ì‚° ë¡œì§ í™•ì¸ (7Ã—7 íƒ€ì¼ ì˜ì—­)
3. LiveKit êµ¬ë… ìƒíƒœ ë””ë²„ê¹…
